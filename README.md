# No Bells, Just Whistles: Sports Field Registration by Leveraging Geometric Properties

<div align="center">

[![Conference](https://img.shields.io/badge/CVPR-2024-6b8bc7.svg?style=for-the-badge)](https://openaccess.thecvf.com/content/CVPR2024W/CVsports/html/Gutierrez-Perez_No_Bells_Just_Whistles_Sports_Field_Registration_by_Leveraging_Geometric_CVPRW_2024_paper.html)
[![arXiv](https://img.shields.io/badge/arXiv-2207.11709-b31b1b.svg?style=for-the-badge)](https://arxiv.org/abs/2404.08401)

</div>

## Contents
- [Abstract](#abstract)
- [Model Weights](#model_weights)
- [Inference / Demo](#inference)
- [Reproduce Paper Results](#reproduce-paper-results)
    - [Datasets](#datasets)
    - [Evaluation](#evaluation)
- [Requirements](#requirements)

<hr>  


## Abstract
Broadcast sports field registration is traditionally addressed as a homography estimation task, mapping the visible image area to a planar field model, predominantly focusing on the main camera shot. Addressing the shortcomings of previous approaches, we propose a novel calibration pipeline enabling camera calibration using a 3D soccer field model and extending the process to assess the multiple-view nature of broadcast videos. Our approach begins with a keypoint generation pipeline derived from SoccerNet dataset annotations, leveraging the geometric properties of the court. Subsequently, we execute classical camera calibration through DLT algorithm in a minimalist fashion, without further refinement. Through extensive experimentation on real-world soccer broadcast datasets such as SoccerNet-Calibration, WorldCup 2014 and TS-WorldCup, our method demonstrates superior performance in both multiple- and single-view 3D camera calibration while maintaining competitive results in homography estimation compared to state-of-the-art techniques
<p align="center"><img src=figures/Pipeline_r.png></p>
<strong>Overview of our proposed framework. Top: Training data generation pipeline. Beginning with SoccerNet annotations,
we utilize field line extraction and ellipse fitting to establish a hierarchical structure for computing each set of keypoints. Bottom: The
encoder-decoder networks produce heatmaps for keypoints and extremities of soccer field lines to extract their positions in the image space.
The obtained keypoint set is augmented with intersections of lines generated by the second model to ensure a sufficient number of points.</strong>

<hr>  

## Model Weights
Download the keypoints and line detection model weights for both single-view and multiple-view configurations. Our models are pre-trained on the SoccerNet distribution and further finetuned on the WC14 and TSWC datasets for enhanced performance.

Single-View
| Model | Finetuned | Link |
| :-- | :-: | :-: |
|Keypoints| X | [**SV_kp**](https://github.com/mguti97/No-Bells-Just-Whistles/releases/download/v1.0.0/SV_kp) |
|Lines| X | [**SV_lines**](https://github.com/mguti97/No-Bells-Just-Whistles/releases/download/v1.0.0/SV_lines) |
|Keypoints| WC14 | [**SV_FT_WC14_kp**](https://github.com/mguti97/No-Bells-Just-Whistles/releases/download/v1.0.0/SV_FT_WC14_kp) |
|Lines| WC14 | [**SV_FT_WC14_lines**](https://github.com/mguti97/No-Bells-Just-Whistles/releases/download/v1.0.0/SV_FT_WC14_lines) |
|Keypoints| TSWC | [**SV_FT_TSWC_kp**](https://github.com/mguti97/No-Bells-Just-Whistles/releases/download/v1.0.0/SV_FT_TSWC_kp) |
|Lines| TSWC | [**SV_FT_TSWC_kp**](https://github.com/mguti97/No-Bells-Just-Whistles/releases/download/v1.0.0/SV_FT_TSWC_lines) |

Multiple-View
| Model | Finetuned | Link |
| :-- | :-: | :-: |
|Keypoints| X | [**MV_kp**](https://github.com/mguti97/No-Bells-Just-Whistles/releases/download/v1.0.0/MV_kp) |
|Lines| X | [**MV_lines**](https://github.com/mguti97/No-Bells-Just-Whistles/releases/download/v1.0.0/MV_lines) |

<hr>

## Inference

